(this["webpackJsonplightning-nespresso-ui"]=this["webpackJsonplightning-nespresso-ui"]||[]).push([[0],{30:function(e){e.exports=JSON.parse('[{"id":1,"name":"Master Origin Ethiopia","description":"Scent of orange blossom, but its notes of compote come from the drying of Arabica coffee cherries in the sun","image":"https://www.nespresso.com/ecom/medias/sys_master/public/10831332802590/C-0363-Ethiopia-2000x2000.png","intensity":4},{"id":2,"name":"Vivalto Lungo","description":"A balanced coffee made from a complex blend of separately roasted South American and East African Arabicas, combining roasted and subtle floral notes","image":"https://www.nespresso.com/ecom/medias/sys_master/public/10386858082334/C-0038-2000x2000.png","intensity":4},{"id":3,"name":"Capriccio Espresso","description":"A mix of Arabica from South America and a touch of Robusta, Capriccio is a rich espresso, with a very characteristic note of cereals","image":"https://www.nespresso.com/ecom/medias/sys_master/public/10386856116254/C-0003-2000x2000.png","intensity":5},{"id":4,"name":"Arpeggio Intenso","description":"Pure Arabica from South and Central America, very roasted, Arpeggio has an intense character and a dense body, reinforced by notes of cocoa","image":"https://www.nespresso.com/ecom/medias/sys_master/public/10386855919646/C-0001-2000x2000.png","intensity":9},{"id":5,"name":"Volluto Decaffeinato","description":"Delightfully sweet and smooth, the selected pure Arabica beans from South America are roasted to reveal the sweet biscuity, fresh and fruity notes","image":"../assets/coffees/volluto.png","intensity":4}]')},31:function(e,t){e.exports="data:image/png;base64,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"},32:function(e,t,n){e.exports=n.p+"static/media/copy.863b1c6c.svg"},33:function(e,t,n){e.exports=n.p+"static/media/enjoy1.ccd3a7c0.gif"},34:function(e,t,n){e.exports=n.p+"static/media/enjoy2.357c2a1b.gif"},35:function(e,t,n){e.exports=n.p+"static/media/enjoy3.f4fd12f4.gif"},39:function(e,t,n){e.exports=n.p+"static/media/ethiopia.900153ef.png"},40:function(e,t,n){e.exports=n.p+"static/media/volluto.6bb947be.png"},41:function(e,t,n){e.exports=n.p+"static/media/arpeggio.7a65b849.png"},42:function(e,t,n){e.exports=n.p+"static/media/capriccio.3840a31d.png"},43:function(e,t,n){e.exports=n.p+"static/media/vivalto.c4615284.png"},44:function(e,t,n){e.exports=n.p+"static/media/bitcoin-studio-black-border.ab347975.svg"},46:function(e,t,n){e.exports=n(81)},48:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);n(47),n(48);var a=n(0),o=n.n(a),r=n(12),c=n.n(r),i=n(3),s=n.n(i),l=n(5),u=n(89),d=n(14),m=n.n(d),f=n(15),p=n(29),E=n.n(p),b=n(30),v=n(45),h=n(90),g=n(82),O=n(83),y=n(87),w=n(88),C=n(31),k=n.n(C),N=n(84),j=n(16),x=n.n(j),A=n(32),L=n.n(A),M=function(e){var t=e.btcEurPrice,n=e.chosenCoffee,r=e.invoiceValue,c=e.paymentRequest,i=Object(a.useContext)(be),u=Object(l.a)(i,2)[1],d=Object(a.useState)(!1),m=Object(l.a)(d,2),f=m[0],p=m[1],E=Object(a.useState)(!1),b=Object(l.a)(E,2),v=b[0],h=b[1],y=Object(a.useCallback)((function(){h(!0),setTimeout((function(){h(!1)}),1e3)}),[h]),w=Object(a.useCallback)((function(){p(!0),setTimeout((function(){p(!1)}),1e3)}),[p]),C=Object(a.useCallback)((function(e){navigator.clipboard.writeText(e).then((function(){s.a.info("Invoice copied to clipboard")})).catch((function(e){s.a.error("Invoice not copied to clipboard",e)}))}),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,{noGutters:!0,className:"invoiceInfo"},o.a.createElement(O.a,{xs:{size:6},className:"invoiceInfo-col1"},o.a.createElement("p",null,null===n||void 0===n?void 0:n.name)),o.a.createElement(O.a,{xs:{size:6},className:"invoiceInfo-col2"},o.a.createElement("p",null,"".concat(r," Sats (").concat("0.50"," EUR)")),o.a.createElement("p",null,"1 BTC ="," ",o.a.createElement("span",null,t)," ","\u20ac (EUR)"))),o.a.createElement(g.a,{noGutters:!0},o.a.createElement(O.a,{xs:{size:6,offset:3}},o.a.createElement("div",{className:"qrcodeWrapper"},o.a.createElement(x.a,{name:"payment request",value:c?c.toUpperCase():"",style:{display:"block",width:"100%",height:"auto"}})))),o.a.createElement(g.a,{noGutters:!0},o.a.createElement(O.a,{xs:{size:12}},o.a.createElement("h6",null,"BOLT 11 INVOICE"),o.a.createElement("p",{className:"monospace"},c))),o.a.createElement(g.a,{noGutters:!0},o.a.createElement("a",{className:"link monospace ".concat(v?"actionLinksClicked":""),href:"lightning:".concat(c),id:"openWithWallet",onClick:function(){return y()}},"OPEN WITH YOUR WALLET"),o.a.createElement("button",{className:"link link--btn monospace ".concat(f?"actionLinksClicked":""),id:"copyIcon",onClick:function(){C(c),w()},type:"button"},o.a.createElement("img",{src:L.a,alt:"copy icon"}),"COPY")),o.a.createElement(g.a,{noGutters:!0},o.a.createElement(O.a,{xs:{size:12}},o.a.createElement(N.a,{outline:!0,color:"warning",onClick:function(){u("CLOSE_MODAL")}},"Cancel Payment"))),o.a.createElement(g.a,{noGutters:!0},o.a.createElement(O.a,{xs:{size:12}},o.a.createElement(N.a,{outline:!0,color:"info",onClick:function(){return u("OPEN_NODE_INFO_MODAL")}},"Node Info"))))},S=n(85),W=function(e){var t=e.error,n=e.isWsConnected,r=e.wsConnect,c=Object(a.useContext)(be),i=Object(l.a)(c,2)[1];return o.a.createElement(S.a,{className:"error-modal",color:"danger"},o.a.createElement("h4",{className:"alert-heading"},"Something went wrong!"),o.a.createElement("p",{className:"error-modal__message"},t),o.a.createElement(N.a,{block:!0,outline:!0,color:"danger",onClick:function(){r(),n&&i("CLOSE_MODAL")}},"Try to reconnect"),o.a.createElement(N.a,{block:!0,outline:!0,color:"danger",onClick:function(){return i("CLOSE_MODAL")}},"Close"))},P=function(e){var t=e.nodeInfo,n=Object(a.useContext)(be),r=Object(l.a)(n,2)[1];return o.a.createElement(o.a.Fragment,null,(null===t||void 0===t?void 0:t.alias)&&o.a.createElement(g.a,{noGutters:!0},o.a.createElement(O.a,{xs:{size:12}},o.a.createElement("h6",null,"Node Alias"),o.a.createElement("p",{className:"monospace"},"".concat(null===t||void 0===t?void 0:t.alias)))),o.a.createElement(g.a,{noGutters:!0},o.a.createElement(O.a,{xs:{size:12}},o.a.createElement("h6",null,"Node ID"),o.a.createElement("p",{className:"monospace"},"".concat(null===t||void 0===t?void 0:t.public_key,"@").concat(null===t||void 0===t?void 0:t.sockets[0].socket)))),o.a.createElement(g.a,{noGutters:!0},o.a.createElement("h6",null,"Open A Direct Channel With This Node"),o.a.createElement(O.a,{xs:{size:6,offset:3}},o.a.createElement("div",{className:"qrcodeWrapper"},o.a.createElement(x.a,{name:"payment request",value:"".concat(null===t||void 0===t?void 0:t.public_key,"@").concat(null===t||void 0===t?void 0:t.sockets[0].socket),style:{display:"block",width:"100%",height:"auto"}})))),o.a.createElement(g.a,{noGutters:!0},o.a.createElement(O.a,{xs:{size:12}},o.a.createElement(N.a,{className:"btn",color:"info",outline:!0,onClick:function(){return r("OPEN_PAYMENT_MODAL")}},"Go Back"))))},I=n(33),q=n.n(I),R=n(34),D=n.n(R),T=n(35),G=n.n(T);var V=[q.a,D.a,G.a],F=V[Math.floor(Math.random()*V.length)],U=function(){var e=Object(a.useContext)(be),t=Object(l.a)(e,2)[1];return function(e,t){var n=Object(a.useRef)(null);Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setTimeout((function(){n.current()}),t);return function(){return clearTimeout(e)}}}),[t])}((function(){t("CLOSE_MODAL")}),8e3),o.a.createElement("div",{className:"invoice-settled"},o.a.createElement("h2",null,"Enjoy Your Coffee!"),o.a.createElement("img",{className:"invoice-settle__image",src:F,alt:"enjoy"}),o.a.createElement(N.a,{outline:!0,color:"success",onClick:function(){t("CLOSE_MODAL")}},"Close"))},z=n(86),_=function(){var e=Object(a.useContext)(be),t=Object(l.a)(e,2)[1],n=Object(a.useState)(0),r=Object(l.a)(n,2),c=r[0],i=r[1],u=0;return function(e,t){var n=Object(a.useRef)(null);Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){u+=1,i((function(e){return e+Number((u/3).toFixed(0))})),s.a.debug("Waiting bar ".concat(c," %")),c>=100&&t("CLOSE_MODAL")}),1e3),o.a.createElement(O.a,{xs:{size:12},className:"progressBar monospace"},o.a.createElement(z.a,{value:c},o.a.createElement("span",{className:"progress-bar__text"},"Awaiting Payment...")))},H=function(e){var t,n=e.btcEurPrice,r=e.chosenCoffee,c=e.error,i=e.invoiceValue,s=e.isWsConnected,u=e.nodeInfo,d=e.paymentRequest,m=e.wsConnect,f=Object(a.useContext)(be),p=Object(l.a)(f,2),E=p[0],b=p[1];switch(!0){case E.paymentModal:t=o.a.createElement(M,{btcEurPrice:n,chosenCoffee:r,invoiceValue:i,paymentRequest:d});break;case E.nodeInfoModal:t=o.a.createElement(P,{nodeInfo:u});break;case E.invoiceSettled:t=o.a.createElement(U,null);break;case E.errorModal:t=o.a.createElement(W,{error:c,isWsConnected:s,wsConnect:m});break;default:t=o.a.createElement(M,{btcEurPrice:n,chosenCoffee:r,invoiceValue:i,paymentRequest:d})}E.isModalOpen;var C=Object(v.a)(E,["isModalOpen"]),N=Object.values(C).some((function(e){return!0===e}));return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.a,{className:"app-modal",isOpen:N,returnFocusAfterClose:!1,toggle:function(){b("CLOSE_MODAL")}},o.a.createElement(g.a,{"data-testid":"app-modal__header",noGutters:!0},o.a.createElement(O.a,{xs:{size:2}},o.a.createElement("img",{src:k.a,alt:"logo"})),o.a.createElement(O.a,{xs:{size:10},className:"titleModal"},o.a.createElement("p",{id:"dialogTitle"},"Lightning Nespresso"))),o.a.createElement(y.a,null,o.a.createElement(w.a,null,(E.paymentModal||E.nodeInfoModal)&&o.a.createElement(g.a,{noGutters:!0},o.a.createElement(_,null)),t))))},Y=n(36),X=n(37),B=n(38),Z=new(function(){function e(t){Object(Y.a)(this,e),this.url=void 0,this.url=t}return Object(X.a)(e,[{key:"generatePaymentRequest",value:function(e,t){return this.request("POST","/generatePaymentRequest",{memo:e,value:t})}},{key:"getNodeInfo",value:function(){return this.request("GET","/getNodeInfo",{})}},{key:"getPrice",value:function(){return this.request("GET","/getPrice",{})}},{key:"getWebSocket",value:function(){var e=this.url.replace("https","wss").replace("http","ws");return new WebSocket("".concat(e,"/ws"))}},{key:"request",value:function(e,t,n){var a=null,o="",r=new Headers;return r.append("Accept","application/json"),"POST"===e||"PUT"===e?(a=JSON.stringify(n),r.append("Content-Type","application/json")):void 0!==n&&(o="?".concat(Object(B.stringify)(n))),fetch(this.url+t+o,{method:e,headers:r,body:a}).then(function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=14;break}return e.prev=1,e.next=4,t.json();case 4:if((a=e.sent).error){e.next=7;break}throw new Error;case 7:n=a.error,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),new Error("".concat(t.status,": ").concat(t.statusText));case 13:throw new Error(n);case 14:return e.abrupt("return",t.json());case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()).then((function(e){return e.data})).catch((function(n){throw s.a.error("API error calling ".concat(e," ").concat(t),n),n}))}}]),e}())("https://openfaas-ingress-janaka-steph.cloud.okteto.net/function/lightning-nespresso-api/api"),K=n(39),J=n.n(K),Q=n(40),$=n.n(Q),ee=n(41),te=n.n(ee),ne=n(42),ae=n.n(ne),oe=n(43),re=n.n(oe),ce=[J.a,re.a,ae.a,te.a,$.a],ie=0,se={id:0,name:""},le=0,ue="",de="",me=function(e){var t=e.error,n=e.isWsConnected,r=e.nodeInfo,c=e.setError,i=e.wsClientId,u=e.wsConnect,d=Object(a.useContext)(be),p=Object(l.a)(d,2),v=p[0],h=p[1],g=Object(a.useState)(0),O=Object(l.a)(g,2),y=O[0],w=O[1],C=Object(a.useState)(0),k=Object(l.a)(C,2),N=k[0],j=k[1],x=Object(a.useState)(null),A=Object(l.a)(x,2),L=A[0],M=A[1],S=Object(a.useState)(null),W=Object(l.a)(S,2),P=W[0],I=W[1],q=new Map,R=Object(a.useRef)(E()(function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,o,r,i,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.a.info("GENERATE PAYMENT REQUEST"),s.a.debug("chosenCoffee",t),M(t),e.prev=3,s.a.debug("Generate an invoice for ".concat(null===t||void 0===t?void 0:t.name,", row ").concat(null===t||void 0===t?void 0:t.id)),e.next=8,Z.getPrice();case 8:if(o=e.sent,r=Number(o.EUR.toFixed(0)),w(r),s.a.debug("Price BTCEUR ",r),a=1,s.a.debug("Invoice amount (sats) ",a),!(a>2e4)){e.next=17;break}return s.a.error("invoiceAmount greater than 20 000 sats"),e.abrupt("return");case 17:e.next=20;break;case 19:a=Number("0.50");case 20:return j(a),i="#".concat(null===t||void 0===t?void 0:t.id," ").concat(null===t||void 0===t?void 0:t.name," - The Block / @").concat(n),e.next=24,Z.generatePaymentRequest(i,a);case 24:l=e.sent,I(l.paymentRequest),h("OPEN_PAYMENT_MODAL"),e.next=34;break;case 29:e.prev=29,e.t0=e.catch(3),s.a.error(e.t0.message),c("Sorry, the application failed to generate your invoice. \nThe merchant's Bitcoin node seems unavailable."),h("OPEN_ERROR_MODAL");case 34:case"end":return e.stop()}}),e,null,[[3,29]])})));return function(t,n){return e.apply(this,arguments)}}(),3e3,{leading:!0,trailing:!1})).current;Object(a.useEffect)((function(){v.isModalOpen||(s.a.debug("EFFECT CLEAR STATE WHEN MODAL IS CLOSE"),w(ie),M(se),j(le),I(ue),c(de))}),[v.isModalOpen,c]);var D=b.map((function(e,t){return o.a.createElement("div",{className:"coffee",key:e.name},o.a.createElement("img",{src:ce[t],alt:"Nespresso capsule"}),o.a.createElement("h2",null,e.name),o.a.createElement("p",null,e.description),o.a.createElement("div",{className:"intensity"},o.a.createElement("p",{className:"intensity__title"},"Intensity"),o.a.createElement("div",{className:"intensity__squares"},Array.from(Array(12)).map((function(t,n){return o.a.createElement("div",{className:"intensity__square ".concat(n+1<=e.intensity?"intensity__square-active":""),key:"intensity_".concat(e.name,"_").concat(n)})})))),o.a.createElement("button",{className:"buttonBuy",tabIndex:t+1,key:"button_".concat(e.name),ref:function(e){return q.set(t,e)},type:"button",onClick:function(){!function(e){q.get(e).focus()}(t),R({id:t+1,name:e.name},i)}},"Buy for ".concat("0.50").concat("\u20ac")))}));return o.a.createElement(o.a.Fragment,null,D,o.a.createElement(H,{btcEurPrice:y,chosenCoffee:L,error:t,isWsConnected:n,invoiceValue:N,nodeInfo:r,paymentRequest:P,wsConnect:u}))},fe=n(44),pe=n.n(fe),Ee=function(e){var t=e.children;return o.a.createElement(o.a.Fragment,null,o.a.createElement("header",null,o.a.createElement("a",{href:"https://www.bitcoin-studio.com",rel:"noopener noreferrer",target:"_blank"},o.a.createElement("img",{id:"BitcoinStudioLogo",src:pe.a,alt:"Bitcoin Studio Logo"})),o.a.createElement("h1",{className:"header__title"},"CHOOSE YOUR COFFEE")),o.a.createElement("main",null,t),o.a.createElement("footer",null,o.a.createElement("p",null,"Made By"," ",o.a.createElement("a",{href:"https://www.bitcoin-studio.com",rel:"noopener noreferrer",target:"_blank"},"Bitcoin Studio")," ","With Love \u2764\ufe0f")))},be=o.a.createContext({}),ve=function(){var e,t=Object(a.useState)(""),n=Object(l.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(!1),d=Object(l.a)(i,2),m=d[0],f=d[1],p=Object(a.useState)(""),E=Object(l.a)(p,2),b=E[0],v=E[1],h=Object(a.useState)(null),g=Object(l.a)(h,2),O=g[0],y=g[1],w=Object(a.useCallback)((function(e,t){switch(s.a.debug("prevState: ",e),s.a.debug("action: ",t),t){case"OPEN_ERROR_MODAL":return{isModalOpen:!0,errorModal:!0,invoiceSettled:!1,nodeInfoModal:!1,paymentModal:!1};case"OPEN_NODE_INFO_MODAL":return{isModalOpen:!0,errorModal:!1,invoiceSettled:!1,nodeInfoModal:!0,paymentModal:!1};case"OPEN_PAYMENT_MODAL":return{isModalOpen:!0,errorModal:!1,invoiceSettled:!1,nodeInfoModal:!1,paymentModal:!0};case"OPEN_INVOICE_SETTLED_MODAL":return{isModalOpen:!0,errorModal:!1,invoiceSettled:!0,nodeInfoModal:!1,paymentModal:!1};case"CLOSE_MODAL":return{isModalOpen:!1,errorModal:!1,invoiceSettled:!1,nodeInfoModal:!1,paymentModal:!1};default:throw new Error("Unexpected modal reducer action: ".concat(t))}}),[]),C=Object(a.useReducer)(w,{isModalOpen:!1,errorModal:!1,invoiceSettled:!1,nodeInfoModal:!1,paymentModal:!1}),k=Object(l.a)(C,2),N=k[0],j=k[1],x=[N,j],A=Object(a.useCallback)((function(){s.a.info("Establish websocket connection with the server...");var e=Z.getWebSocket();e.addEventListener("open",(function(e){f(!0);var t=e.currentTarget.readyState;s.a.info("Websocket connected to server successfully"),s.a.debug("readyState: ",t)})),e.addEventListener("message",(function(e){try{var t=e.currentTarget.readyState;if(1!==t)return void s.a.warn("Websocket not ready. readyState",t);var n=JSON.parse(e.data.toString());n&&"client-id"===n.type&&(s.a.info("Websocket client ID is",n.data),v(n.data)),n&&"invoice-settlement"===n.type&&(s.a.info("Invoice settled!",n.data),j("OPEN_INVOICE_SETTLED_MODAL")),n&&"delivery-failure"===n.type&&(s.a.error("delivery failure",n.data),c("Sorry, we're unable to deliver your coffee. Please check that the machine is properly connected"),j("OPEN_ERROR_MODAL")),n&&"error"===n.type&&(s.a.error("server/LND error",n.data),14===n.data?c("Sorry, the Bitcoin node is unavailable."):c("Sorry, the server has an issue."),j("OPEN_ERROR_MODAL"))}catch(a){s.a.error("Websocket onmessage catch",a)}})),e.addEventListener("close",(function(e){s.a.warn("Websocket close event ",e),c("The connection to the server has closed unexpectedly"),j("OPEN_ERROR_MODAL");var t=e.currentTarget.readyState;s.a.debug("readyState: ",t)})),e.addEventListener("error",(function(e){s.a.error("Websocket connection error",e),c("Websocket connection error"),j("OPEN_ERROR_MODAL")}))}),[]);return Object(a.useEffect)((function(){s.a.debug("EFFECT WEBSOCKET CONNECTION"),A(),s.a.info("Ask server LND node info..."),Z.getNodeInfo().then((function(e){s.a.info("LND node info",e),y(e)})).catch((function(e){s.a.error(e)}))}),[A]),e=m?o.a.createElement(be.Provider,{value:x},o.a.createElement(me,{error:r,isWsConnected:m,nodeInfo:O,setError:c,wsClientId:b,wsConnect:A})):o.a.createElement("div",{className:"d-flex justify-content-center p-5 spinner-container"},o.a.createElement(u.a,{color:"warning"})),o.a.createElement(Ee,null,e)},he=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ge(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(s.a.warn("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(s.a.debug("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){s.a.error("Error during service worker registration:",e)}))}s.a.setLevel("silent"),c.a.render(o.a.createElement(ve,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/function/lightning-nespresso-ui",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/function/lightning-nespresso-ui","/service-worker.js");he?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ge(e,t)})).catch((function(){s.a.warn("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){s.a.info("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ge(t,e)}))}}({onUpdate:function(e){var t=e.waiting;t&&(t.postMessage({type:"SKIP_WAITING"}),t.addEventListener("statechange",(function(e){var t;"activated"===(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.state)&&window.location.reload()})))}})}},[[46,1,2]]]);
//# sourceMappingURL=main.14305962.chunk.js.map